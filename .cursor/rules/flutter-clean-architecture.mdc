---
alwaysApply: true
---

# ğŸ—ï¸ Flutter Clean Architecture Rules

## ğŸš¨ Quy táº¯c nghiÃªm ngáº·t - KHÃ”NG VI PHáº M

### 1. **KHÃ”NG BAO GIá»œ truy cáº­p trá»±c tiáº¿p Service tá»« Cubit/Bloc**

```dart
// âŒ VI PHáº M - Cubit import vÃ  sá»­ dá»¥ng trá»±c tiáº¿p Service
import '../../../core/services/api_service.dart';

class UserCubit extends Cubit<UserState> {
  final ApiService _apiService; // âŒ Truy cáº­p trá»±c tiáº¿p service
```

```dart
// âœ… ÄÃšNG - Cubit chá»‰ sá»­ dá»¥ng UseCases
import '../../../domain/usecases/user/get_user_profile.dart';

class UserCubit extends Cubit<UserState> {
  final GetUserProfile _getUserProfile; // âœ… Sá»­ dá»¥ng usecase
```

### 2. **Báº®T BUá»˜C cÃ³ Domain Layer cho má»i feature**

- âœ… Táº¡o Entity trong `lib/domain/entities/`
- âœ… Táº¡o Repository interface trong `lib/domain/repositories/`
- âœ… Táº¡o UseCase trong `lib/domain/usecases/`
- âŒ KHÃ”NG Ä‘á»‹nh nghÄ©a business logic trong Service

### 3. **Model pháº£i káº¿ thá»«a tá»« Entity**

```dart
// âœ… ÄÃšNG
class UserModel extends User {
  const UserModel({
    required super.id,
    required super.name,
    required super.email,
  });

  factory UserModel.fromMap(Map<String, dynamic> map) {
    return UserModel(
      id: map['id'] ?? '',
      name: map['name'] ?? '',
      email: Email(map['email'] ?? ''),
    );
  }

  Map<String, dynamic> toMap() {
    return {
      'id': id,
      'name': name,
      'email': email.value,
    };
  }
}
```

### 4. **Repository Implementation tráº£ vá» trá»±c tiáº¿p tá»« DataSource**

```dart
// âœ… ÄÃšNG - Tráº£ vá» trá»±c tiáº¿p tá»« DataSource
class UserRepositoryImpl implements UserRepository {
  final UserDataSource _dataSource;

  UserRepositoryImpl({required UserDataSource dataSource})
      : _dataSource = dataSource;

  @override
  Future<User> getUserProfile(String userId) async {
    try {
      return await _dataSource.getUser(userId); // Tráº£ vá» trá»±c tiáº¿p
    } catch (e) {
      throw Exception('Failed to get user profile: $e');
    }
  }
}
```

## ğŸ“‹ Cáº¥u trÃºc thÆ° má»¥c chuáº©n

```
lib/
â”œâ”€â”€ core/                           # Core layer - Shared components
â”‚   â”œâ”€â”€ constants/                  # App constants
â”‚   â”œâ”€â”€ error/                      # Error handling
â”‚   â”œâ”€â”€ utils/                      # Helper functions
â”‚   â”œâ”€â”€ services/                   # Platform services
â”‚   â””â”€â”€ dependency_injection/       # DI setup
â”‚
â”œâ”€â”€ domain/                         # Domain layer - Business logic
â”‚   â”œâ”€â”€ entities/                   # Business entities
â”‚   â”œâ”€â”€ repositories/               # Repository interfaces
â”‚   â”œâ”€â”€ usecases/                   # Business use cases
â”‚   â””â”€â”€ value_objects/              # Value objects
â”‚
â”œâ”€â”€ data/                           # Data layer - External data sources
â”‚   â”œâ”€â”€ models/                     # Data models (káº¿ thá»«a tá»« entities)
â”‚   â”œâ”€â”€ datasources/                # Data sources
â”‚   â””â”€â”€ repositories/               # Repository implementations
â”‚
â””â”€â”€ presentation/                   # Presentation layer - UI
    â”œâ”€â”€ bloc/                       # State management
    â”œâ”€â”€ pages/                      # Page widgets
    â”œâ”€â”€ widgets/                    # Reusable widgets
    â”œâ”€â”€ theme/                      # Theme configuration
    â””â”€â”€ routes/                     # Route management
```

## ğŸ”„ Dependency Flow

```
Presentation Layer â†’ Domain Layer â† Data Layer
       â†“                    â†‘              â†‘
   UI Components    Business Logic   External Data
```

## ğŸ“ Quy trÃ¬nh táº¡o feature má»›i

### BÆ°á»›c 1: Domain Layer

1. Táº¡o Entity trong `lib/domain/entities/`
2. Táº¡o Repository interface trong `lib/domain/repositories/`
3. Táº¡o UseCase trong `lib/domain/usecases/`

### BÆ°á»›c 2: Data Layer

1. Táº¡o Model káº¿ thá»«a Entity trong `lib/data/models/`
2. Táº¡o DataSource trong `lib/data/datasources/`
3. Táº¡o Repository implementation trong `lib/data/repositories/`

### BÆ°á»›c 3: Presentation Layer

1. Táº¡o Cubit/Bloc trong `lib/presentation/bloc/`
2. Táº¡o UI components trong `lib/presentation/widgets/`
3. Táº¡o Pages trong `lib/presentation/pages/`

### BÆ°á»›c 4: Dependency Injection

1. ÄÄƒng kÃ½ dependencies trong `lib/core/dependency_injection/`

## ğŸ” Code Review Checklist

- [ ] **Domain layer khÃ´ng phá»¥ thuá»™c framework**
- [ ] **Cubit chá»‰ sá»­ dá»¥ng UseCases**
- [ ] **Model káº¿ thá»«a Entity**
- [ ] **Repository tráº£ vá» trá»±c tiáº¿p tá»« DataSource**
- [ ] **Dependency injection Ä‘Ã£ Ä‘Äƒng kÃ½ Ä‘áº§y Ä‘á»§**
- [ ] **Import Ä‘Ãºng layer**

## ğŸ“š References

- [lib/domain/entities/](mdc:lib/domain/entities/) - Business entities
- [lib/domain/repositories/](mdc:lib/domain/repositories/) - Repository interfaces
- [lib/domain/usecases/](mdc:lib/domain/usecases/) - Business use cases
- [lib/data/models/](mdc:lib/data/models/) - Data models
- [lib/presentation/bloc/](mdc:lib/presentation/bloc/) - State management

# ğŸ—ï¸ Flutter Clean Architecture Rules

## ğŸš¨ Quy táº¯c nghiÃªm ngáº·t - KHÃ”NG VI PHáº M

### 1. **KHÃ”NG BAO GIá»œ truy cáº­p trá»±c tiáº¿p Service tá»« Cubit/Bloc**

```dart
// âŒ VI PHáº M - Cubit import vÃ  sá»­ dá»¥ng trá»±c tiáº¿p Service
import '../../../core/services/api_service.dart';

class UserCubit extends Cubit<UserState> {
  final ApiService _apiService; // âŒ Truy cáº­p trá»±c tiáº¿p service
```

```dart
// âœ… ÄÃšNG - Cubit chá»‰ sá»­ dá»¥ng UseCases
import '../../../domain/usecases/user/get_user_profile.dart';

class UserCubit extends Cubit<UserState> {
  final GetUserProfile _getUserProfile; // âœ… Sá»­ dá»¥ng usecase
```

### 2. **Báº®T BUá»˜C cÃ³ Domain Layer cho má»i feature**

- âœ… Táº¡o Entity trong `lib/domain/entities/`
- âœ… Táº¡o Repository interface trong `lib/domain/repositories/`
- âœ… Táº¡o UseCase trong `lib/domain/usecases/`
- âŒ KHÃ”NG Ä‘á»‹nh nghÄ©a business logic trong Service

### 3. **Model pháº£i káº¿ thá»«a tá»« Entity**

```dart
// âœ… ÄÃšNG
class UserModel extends User {
  const UserModel({
    required super.id,
    required super.name,
    required super.email,
  });

  factory UserModel.fromMap(Map<String, dynamic> map) {
    return UserModel(
      id: map['id'] ?? '',
      name: map['name'] ?? '',
      email: Email(map['email'] ?? ''),
    );
  }

  Map<String, dynamic> toMap() {
    return {
      'id': id,
      'name': name,
      'email': email.value,
    };
  }
}
```

### 4. **Repository Implementation tráº£ vá» trá»±c tiáº¿p tá»« DataSource**

```dart
// âœ… ÄÃšNG - Tráº£ vá» trá»±c tiáº¿p tá»« DataSource
class UserRepositoryImpl implements UserRepository {
  final UserDataSource _dataSource;

  UserRepositoryImpl({required UserDataSource dataSource})
      : _dataSource = dataSource;

  @override
  Future<User> getUserProfile(String userId) async {
    try {
      return await _dataSource.getUser(userId); // Tráº£ vá» trá»±c tiáº¿p
    } catch (e) {
      throw Exception('Failed to get user profile: $e');
    }
  }
}
```

## ğŸ“‹ Cáº¥u trÃºc thÆ° má»¥c chuáº©n

```
lib/
â”œâ”€â”€ core/                           # Core layer - Shared components
â”‚   â”œâ”€â”€ constants/                  # App constants
â”‚   â”œâ”€â”€ error/                      # Error handling
â”‚   â”œâ”€â”€ utils/                      # Helper functions
â”‚   â”œâ”€â”€ services/                   # Platform services
â”‚   â””â”€â”€ dependency_injection/       # DI setup
â”‚
â”œâ”€â”€ domain/                         # Domain layer - Business logic
â”‚   â”œâ”€â”€ entities/                   # Business entities
â”‚   â”œâ”€â”€ repositories/               # Repository interfaces
â”‚   â”œâ”€â”€ usecases/                   # Business use cases
â”‚   â””â”€â”€ value_objects/              # Value objects
â”‚
â”œâ”€â”€ data/                           # Data layer - External data sources
â”‚   â”œâ”€â”€ models/                     # Data models (káº¿ thá»«a tá»« entities)
â”‚   â”œâ”€â”€ datasources/                # Data sources
â”‚   â””â”€â”€ repositories/               # Repository implementations
â”‚
â””â”€â”€ presentation/                   # Presentation layer - UI
    â”œâ”€â”€ bloc/                       # State management
    â”œâ”€â”€ pages/                      # Page widgets
    â”œâ”€â”€ widgets/                    # Reusable widgets
    â”œâ”€â”€ theme/                      # Theme configuration
    â””â”€â”€ routes/                     # Route management
```

## ğŸ”„ Dependency Flow

```
Presentation Layer â†’ Domain Layer â† Data Layer
       â†“                    â†‘              â†‘
   UI Components    Business Logic   External Data
```

## ğŸ“ Quy trÃ¬nh táº¡o feature má»›i

### BÆ°á»›c 1: Domain Layer

1. Táº¡o Entity trong `lib/domain/entities/`
2. Táº¡o Repository interface trong `lib/domain/repositories/`
3. Táº¡o UseCase trong `lib/domain/usecases/`

### BÆ°á»›c 2: Data Layer

1. Táº¡o Model káº¿ thá»«a Entity trong `lib/data/models/`
2. Táº¡o DataSource trong `lib/data/datasources/`
3. Táº¡o Repository implementation trong `lib/data/repositories/`

### BÆ°á»›c 3: Presentation Layer

1. Táº¡o Cubit/Bloc trong `lib/presentation/bloc/`
2. Táº¡o UI components trong `lib/presentation/widgets/`
3. Táº¡o Pages trong `lib/presentation/pages/`

### BÆ°á»›c 4: Dependency Injection

1. ÄÄƒng kÃ½ dependencies trong `lib/core/dependency_injection/`

## ğŸ” Code Review Checklist

- [ ] **Domain layer khÃ´ng phá»¥ thuá»™c framework**
- [ ] **Cubit chá»‰ sá»­ dá»¥ng UseCases**
- [ ] **Model káº¿ thá»«a Entity**
- [ ] **Repository tráº£ vá» trá»±c tiáº¿p tá»« DataSource**
- [ ] **Dependency injection Ä‘Ã£ Ä‘Äƒng kÃ½ Ä‘áº§y Ä‘á»§**
- [ ] **Import Ä‘Ãºng layer**

## ğŸ“š References

- [lib/domain/entities/](mdc:lib/domain/entities/) - Business entities
- [lib/domain/repositories/](mdc:lib/domain/repositories/) - Repository interfaces
- [lib/domain/usecases/](mdc:lib/domain/usecases/) - Business use cases
- [lib/data/models/](mdc:lib/data/models/) - Data models
- [lib/presentation/bloc/](mdc:lib/presentation/bloc/) - State management
